<!DOCTYPE html>
<html>
<head>
    <title>Calculadora Huella de Carbono</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <h1>Calculadora de Huella de Carbono</h1>
    <form id="carbonForm">
        <h3>Datos personales</h3>
        <label>Nombre:</label>
        <input type="text" name="name" required><br>
        <label>Matrícula:</label>
        <input type="text" name="matricula" required><br>
        <label>Edad:</label>
        <input type="number" name="age" required><br>
        <label>Correo:</label>
        <input type="email" name="email" required><br>

        <h3>Transporte</h3>
        <label>Modo de transporte:</label>
        <select name="transport_mode" required>
            <option value="walk">Caminar</option>
            <option value="bike">Bicicleta</option>
            <option value="bus">Bus</option>
            <option value="car_shared">Auto compartido</option>
            <option value="car_solo">Auto propio (solo)</option>
        </select><br>
        <label>Distancia mensual (km):</label>
        <input type="number" name="transport_distance" step="0.1" required><br>

        <h3>Electricidad en vivienda</h3>
        <label>Consumo mensual (kWh):</label>
        <input type="number" name="electricity_use" step="0.1" required><br>

        <h3>Uso de computadoras en laboratorio</h3>
        <label>Horas de uso al mes:</label>
        <input type="number" name="lab_pc_usage_hours" step="0.1" required><br>
        <label>Comportamiento:</label>
        <select name="lab_pc_behavior" required>
            <option value="off">Siempre apaga</option>
            <option value="sleep">Suspensión</option>
            <option value="on">Deja encendida</option>
        </select><br>

        <h3>Comidas fuera de casa</h3>
        <label>Comidas con carne roja/mes:</label>
        <input type="number" name="meals_red_meat" min="0" required><br>
        <label>Comidas con carne blanca/mes:</label>
        <input type="number" name="meals_white_meat" min="0" required><br>
        <label>Comidas vegetarianas/mes:</label>
        <input type="number" name="meals_vegetarian" min="0" required><br>

        <h3>Gestión de residuos</h3>
        <select name="waste_management" required>
            <option value="compost">Composta</option>
            <option value="separated">Separado</option>
            <option value="mixed">Todo junto</option>
        </select><br><br>

        <button type="submit">Calcular Huella</button>
    </form>
    <div id="resultado"></div>
    <script>
    document.getElementById('carbonForm').onsubmit = async function(e) {
        e.preventDefault();
        const form = e.target;
        const data = {};
        for (const el of form.elements) {
            if (el.name) data[el.name] = el.value;
        }
        const res = await fetch('http://localhost:5000/api/huella', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        const json = await res.json();
        document.getElementById('resultado').innerHTML =
            '<h2>Huella de carbono: ' + json.huella_carbono + ' kg CO₂e</h2>';
    };
    </script>
</body>
</html>
